@{
    ViewBag.Title = "Snek@MadLabs";
    Layout = "_GameLayout";
}


@section JavaScriptIncludes 
{
    <script language="javascript" type="text/javascript" src="~/SnekScripts/Scene/Scene.js"></script>
    <script language="javascript" type="text/javascript" src="~/SnekScripts/Characters/Snake.js"></script>
    <script language="javascript" type="text/javascript" src="~/SnekScripts/Utility/Util.js"></script>
}

<script type="text/javascript">

    Execute = function (scene)
    {
        scene.Update();
        scene.Draw();
    };

    var _mainLoop = function (delta)
    {
        window.requestAnimationFrame(_mainLoop);
        //var step = delta - lastFrame;
        //lastFrame = delta;

        Scene.Update();
        Scene.Draw();
    }

    window.onload = function()
    {
        var canvas = document.createElement("canvas");
        var fps = 55;
        canvas.setAttribute("width", 600);
        canvas.setAttribute("height", 600);
        canvas.setAttribute("style", "position: absolute; x:0; y:0;border:1px solid #000000;");
        document.body.appendChild(canvas);

        Scene = new Scene("SNEK!", canvas);

        document.addEventListener("keydown", function (event) 
        {
            var directionToGo = null;
            switch (event.key) {
                case "ArrowUp":
                case "w":
                    directionToGo = "up";
                    break;
                case "ArrowDown":
                case "s":
                    directionToGo = "down";
                    break;
                case "ArrowLeft":
                case "a":
                    directionToGo = "left";
                    break;
                case "ArrowRight":
                case "d":
                    directionToGo = "right";
                    break;
                case "q":
                    directionToGo = "EAT!!";
                    break;
            }

            Scene.ChangeDirection(directionToGo);
        });

        //setInterval(Execute, 1000 / fps, scene);
        //requestAnimationFrame(_mainLoop);
        _mainLoop();
    }
   
</script>